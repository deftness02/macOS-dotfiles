#!/usr/bin/env bash

###############################################################################
# macOS Configuration Script                                                   #
###############################################################################
# This file is based largely upon the efforts of:
# ~/.macos — https://mths.be/macos
# See my repo readme for more credits:
# https://github.com/leftygamer02/macOS-dotfiles

# To begin, the System Preferences (pre-Ventura / Settings (post-Ventura) app 
# must be closed so as to prevent it from overwriting any changes to take
# place in this script.
osascript -e 'tell application "System Preferences" to quit'

# Now ask for an administrator/SU password
sudo -v

# For the duration of the .macos script's execution, the sudo session will be 
# maintained with checks every 60 seconds.
while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

###############################################################################
## Set Opts                                                                  ##
###############################################################################
# TODO: Add descriptions of opts for context 

# This is the list of opts I'm presented with using macOS Ventura.
# Sources used include:
# - https://ss64.com/osx/set.html
# - https://zsh.sourceforge.io/Doc/Release/Options.html
# - 

# Opt Name            Default     Description
# noaliases             off       
# aliasfuncdef          off       Allows the definition of functions, such as using 
#                                 the ‘name ()’ syntax if name was expanded as 
#                                 an alias.
# allexport             off       Mark variables which are modified or created 
#                                 for export.
# noalwayslastprompt    off       
# alwaystoend           off       If a completion is performed with the cursor 
#                                 within a word, and a full completion is inserted, 
#                                 the cursor is moved to the end of the word.
# appendcreate          off       
# noappendhistory       off       
# autocd                off
# autocontinue          off       
# noautolist            off       Prevents list choices on an ambiguous completion. 
# noautomenu            off       Prevents use menu completion after the second 
#                                 consecutive request for completion, such as 
#                                 pressing the tab key repeatedly.
# autonamedirs          off       Any parameter that is set to the absolute name 
#                                 of a directory immediately becomes a name for 
#                                 that directory, that will be used by the ‘%~’ 
#                                 and related prompt sequences, and will be available 
#                                 when completion is performed on a word starting with ‘~’.
# noautoparamkeys       off       
# noautoparamslash      off       
# autopushd             off       
# noautoremoveslash     off       
# autoresume            off       
# nobadpattern          off       
# nobanghist            off       
# nobareglobqual        off       
# bashautolist          off       
# bashrematch           off       
# nobeep                off       Prevents the device from audible beeps upon 
#                                 encountering an error.
# nobgnice              off       
# braceccl              off       
# bsdecho               off       
# nocaseglob            off       
# nocasematch           off       
# cbases                off       
# cdablevars            off       
# cdsilent              off       
# chasedots             off       
# chaselinks            off       
# nocheckjobs           off       
# nocheckrunningjobs    off       
# noclobber             off       Prevent output redirection using `>', `>&',
#                                 and `<>' from overwriting existing files.
# combiningchars        on        
# completealiases       off       Prevents aliases on the command line from being internally 
#                                 substituted before completion is attempted.
# completeinword        off       
# continueonerror       off       
# correct               off       
# correctall            off       
# cprecedences          off       
# cshjunkiehistory      off       
# cshjunkieloops        off       
# cshjunkiequotes       off       
# cshnullcmd            off       
# cshnullglob           off       
# nodebugbeforecmd      off       
# dvorak                off       
# emacs                 off         
# noequals              off       
# errexit               off       Exit immediately if a simple command exits with a non-zero status, unless
#                                 the command that fails is part of an until or  while loop, part of an
#                                 if statement, part of a && or || list, or if the command's return status
#                                 is being inverted using !.
# errreturn             off       
# noevallineno          off       
# noexec                off       
# extendedglob          off       
# extendedhistory       off       
# noflowcontrol          off       
# forcefloat             off       
# nofunctionargzero     off       
# noglob                off       Disable file name generation (globbing).
# noglobalexport        off       
# noglobalrcs           off         
# globassign            off         
# globcomplete          off         
# globdots              off         
# globstarshort         off       
# globsubst             off       
# nohashcmds            off       Locate and remember (hash) commands as they are looked
#                                 up for execution. This option is enabled by default.
# nohashdirs            off       
# hashexecutablesonly   off       
# nohashlistall         off       
# histallowclobber      off       
# nohistbeep            off       
# histexpiredupsfirst    off        
# histfcntllock         off       
# histfindnodups         off        
# histignorealldups     off       
# histignoredups        off       
# histignorespace       off       
# histlexwords          off       
# histnofunctions       off       
# histnostore           off       
# histreduceblanks      off       
# nohistsavebycopy      off       
# histsavenodups        off       
# histsubstpattern      off       
# histverify            off       
# nohup                 off       
# ignorebraces          off       
# ignoreclosebraces     off       The shell will perform brace expansion if activated.
# ignoreeof             off       
# incappendhistory      off       
# incappendhistorytime  off       
# interactive           on        
# interactivecomments   off       
# ksharrays             off       
# kshautoload           off       
# kshglob               off       
# kshoptionprint        off       
# kshtypeset            off       
# kshzerosubscript      off       
# nolistambiguous       off       
# nolistbeep            off       
# listpacked            off       
# listrowsfirst          off        
# nolisttypes           off       
# localloops            off       
# localoptions          off       
# localpatterns         off       
# localtraps            off       
# login                 on        
# longlistjobs          off       
# magicequalsubst       off       
# mailwarning           off       
# markdirs              off       
# menucomplete          off       
# monitor               on        
# nomultibyte           off       
# nomultifuncdef        off       
# nomultios             off       
# nonomatch             off       
# nonotify              off       Cause the status of terminated background jobs to be 
#                                 reported immediately, rather than before printing the
#                                 next primary prompt.
# nullglob              off       
# numericglobsort       off       
# octalzeroes           off       
# overstrike            off       Defaults the editor to "insert" mode. This replaces 
#                                 the character to the right with each keystroke.
# pathdirs              off       
# pathscript            off       
# pipefail              off       
# posixaliases          off       
# posixargzero          off       
# posixbuiltins         off       
# posixcd               off       
# posixidentifiers       off        
# posixjobs             off       
# posixstrings          off       
# posixtraps            off       
# printeightbit         off       
# printexitvalue        off       
# privileged            off       
# promptbang            off       
# nopromptcr            off       
# nopromptpercent       off       
# nopromptsp            off       
# promptsubst           off       
# pushdignoredups       off       
# pushdminus            off       
# pushdsilent           off       
# pushdtohome           off       
# rcexpandparam         off       
# rcquotes              off       
# norcs                 off       
# recexact              off       
# rematchpcre           off       
# restricted            off       
# rmstarsilent          off       
# rmstarwait            off       
# sharehistory          off       
# shfileexpansion        off        
# shglob                off       
# shinstdin             on        
# shnullcmd             off       
# shoptionletters       off       
# noshortloops          off       
# shwordsplit           off       
# singlecommand         off       
# singlelinezle         off       When activated, this prevents multi-line editing.
# sourcetrace           off       
# sunkeyboardhack       off       
# transientrprompt      off       
# trapsasync            off       
# typesetsilent         off       
# nounset               off       
# verbose               off       
# vi                    off       
# warncreateglobal      off       
# warnnestedvar         off       
# xtrace                off       
# zle                   on        

# Turn off some options
optOff=(
    
)
echo "Turning off opts..."
set +o "${optOff[@]}"


# Here are the opts if you're using bash
# Opt                 Default     Description
# cdable_vars    	        off     
# cdspell        	        off     
# checkhash      	        off       
# checkwinsize   	        off       
# cmdhist        	        on        
# compat31       	        off       
# dotglob        	        off       
# execfail       	        off       
# expand_aliases 	        on        
# extdebug       	        off       
# extglob        	        off
# extquote       	        on
# failglob       	        off
# force_fignore  	        on
# gnu_errfmt     	        off
# histappend     	        off
# histreedit     	        off
# histverify     	        off
# hostcomplete   	        on
# huponexit      	        off
# interactive_comments	  on
# lithist        	        off
# login_shell    	        off
# mailwarn       	        off
# no_empty_cmd_completion	off
# nocaseglob     	        off
# nocasematch    	        off
# nullglob       	        off
# progcomp       	        on
# promptvars     	        on
# restricted_shell	      off
# shift_verbose  	        off
# sourcepath     	        on
# xpg_echo       	        off

# Turn off some options
shoptOff=(
    history
    noaliases
    extendedhistory
    noglob
    nohashcmds
    nohashdirs
    login
    privileged
    sharehistory
    sunkeyboardhack
    zle
)
echo "Turning off opts..."
set +o "${shoptOff[@]}"

# Turn on some options
shoptOn=(
    errexit
    nounset
    pipefail
    nobeep
    noexec
    histnostore
    ignoreeof
    localoptions
    markdirs
    nonotify
    norcs
    sourcetrace
    trapsasync
    xtrace
)
echo "Turning on opts..."
set -o "${shoptOn[@]}"

(shopt -p inherit_errexit &>/dev/null) && shopt -s inherit_errexit


###############################################################################
## General UI/UX                                                             ##
###############################################################################

# Turn off all audio when the system is booting.
nvram SystemAudioVolume=" "
nvram StartupMute=%01

# Disable transparency in the menu bar and elsewhere in macOS.
defaults write com.apple.universalaccess reduceTransparency -bool true

# Set the highlight color to green.
defaults write -g AppleHighlightColor -string "0.764700 0.976500 0.568600"

# Increase the speed of dialog boxes resizing.
defaults write -g NSWindowResizeTime -float 0.001

# Set the default sidebar icon size to medium.
defaults write -g NSTableViewDefaultSizeMode -int 2

# Disable resuming any previously-opened apps system-wide.
defaults write com.apple.systempreferences NSQuitAlwaysKeepsWindows -bool false

# Disable automatic termination of inactive apps.
defaults write -g NSDisableAutomaticTermination -bool true

# Always show scrollbars to get rid of animation and such.
# Possible values: `WhenScrolling`, `Automatic` and `Always`
defaults write -g AppleShowScrollBars -string "Always"

# Disable the over-the-top focus ring animation.
defaults write -g NSUseAnimatedFocusRing -bool false

# Reveal IP address, hostname, OS version, etc. when clicking the clock
# from the login window.
sudo defaults write /Library/Preferences/com.apple.loginwindow AdminHostInfo HostName

# Disable Notification Center and remove the menu bar icon.
launchctl unload -w /System/Library/LaunchAgents/com.apple.notificationcenterui.plist 2> /dev/null

# Disable automatic capitalization as it’s annoying when typing code.
defaults write -g NSAutomaticCapitalizationEnabled -bool false

# Disable smart dashes as they’re annoying when typing code.
defaults write -g NSAutomaticDashSubstitutionEnabled -bool false

# Disable automatic period substitution as it’s annoying when typing code.
defaults write -g NSAutomaticPeriodSubstitutionEnabled -bool false

# Disable smart quotes as they’re annoying when typing code.
defaults write -g NSAutomaticQuoteSubstitutionEnabled -bool false

# Disable auto-correct because it's really annoying when typing code.
defaults write -g NSAutomaticSpellingCorrectionEnabled -bool false

# Disable automatic spell checking for reduced resource usage.
defaults write -g NSAllowContinuousSpellChecking -bool false

# Disable smooth scrolling. This is done to reduce animations and save computer
# resources for more important stuff.
defaults write -g NSScrollAnimationEnabled -bool false # Default is true
defaults write -g AppleScrollAnimationEnabled -bool false # Default is true

# Remove all window animation effects when opening/closing windows to speed
# things up a little.
defaults write -g NSAutomaticWindowAnimationsEnabled -bool false # Default is true
defaults write -g DisablePasswordManagerAnimations -bool true # Default is false

# To further speed things up, remove the animations for Quick Look windows.
defaults write -g QLPanelAnimationDuration -float 0

# While iCloud is great and all, let's disable it as a default location when
# saving new files.
defaults write -g NSDocumentSaveNewDocumentsToCloud -bool false # Default is true

# Don't show the Open panel when launching apps like TextEdit or Preview if opened
# without a target file already selected.
defaults write -g NSShowAppCentricOpenPanelInsteadOfUntitledFile -bool false

# Automatically expand the Save panel by default.
defaults write -g NSNavPanelExpandedStateForSaveMode -bool true
defaults write -g NSNavPanelExpandedStateForSaveMode2 -bool true

# Expand the Save dialog window by default for convenience.
defaults write -g NSNavPanelExpandedStateForSaveMode -bool true

# Increase tracking speed beyond the maximum allowable value you can select in
# the System Preferences / Settings app (which is 3.0).
defaults write -g com.apple.mouse.scaling -float 5.0

# Stop the cursor/caret from blinking.
defaults write -g NSTextInsertionPointBlinkPeriodOff -float 0
defaults write -g NSTextInsertionPointBlinkPeriodOn -float 999999999999

# Don't treat period or colon as part of a word when parsing.
# The value `en_US_POSIX` corresponds to the "United States (Computer)" setting 
# that was shown in System Preferences in 10.8 and earlier.
defaults write -g AppleTextBreakLocale en_US_POSIX

# Display ASCII control characters in caret notation.
defaults write -g NSTextShowsControlCharacters -bool true

# Add a context menu item for showing the web inspector to web views.
defaults write -g WebKitDeveloperExtras -bool true

# Increase the speed of scrolling by dragging.
defaults write -g NSAutoscrollResponseMultiplier -float 3

# Don't include shadows in screenshots of windows
defaults write com.apple.screencapture disable-shadow -bool true

# Omit crash report dialogs.
defaults write com.apple.CrashReporter DialogType none

# Don't show a warning when opening files downloaded from the internet.
# This does not disable warnings shown when opening an application for the first time.
defaults write com.apple.LaunchServices LSQuarantine -bool false

# Don't verify disk images and don't run fsck on quarantined disk images.
defaults write com.apple.frameworks.diskimages skip-verify -bool true
defaults write com.apple.frameworks.diskimages auto-fsck -bool true

# Don't save .DS_Store files on network volumes.
defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool true

###############################################################################
## Accessibility Settings                                                    ##
###############################################################################

defaults write com.apple.Accessibility EnhancedBackgroundContrastEnabled -bool true
defaults write com.apple.Accessibility FullKeyboardAccessFocusRingEnabled -bool false
defaults write com.apple.Accessibility ReduceMotionEnabled -bool true
defaults write com.apple.Accessibility FullKeyboardAccessEnabled -bool false
defaults write com.apple.Accessibility DarkenSystemColors -bool true

###############################################################################
## Bluetooth                                                                 ##
###############################################################################

sudo defaults write /Library/Preferences/com.apple.Bluetooth ControllerPowerState -int 0 && \
sudo killall -HUP bluetoothd

# Uncomment to enable Bluetooth again.
# sudo defaults write /Library/Preferences/com.apple.Bluetooth ControllerPowerState -int 1

###############################################################################
## Bonjour                                                                 ##
###############################################################################

# Disable the Bonjour service.
defaults write /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist ProgramArguments -array-add "-NoMulticastAdvertisements"
dscacheutil -flushcache && \
killall -HUP mDNSResponder

###############################################################################
## Dock, Dashboard, and Hot Corners                                          ##
###############################################################################

defaults write com.apple.dock launchanim -bool false
defaults write com.apple.dock show-recents -bool false
defaults write com.apple.dock autohide -bool false
defaults write com.apple.dock magnification -bool false
defaults write com.apple.dock mineffect -string "scale"
defaults write com.apple.dock minimize-to-application -bool true
defaults write com.apple.dock tilesize -int 50
defaults write com.apple.dock wvous-br-corner -int 0

###############################################################################
## Finder                                                                    ##
###############################################################################

defaults write com.apple.finder NewWindowTarget -string "PfLo"
defaults write com.apple.finder NewWindowTargetPath -string "file://${HOME}"

# Don't open a Finder window when extracting an archive.
defaults write com.apple.archiveutility dearchive-reveal-after -bool false

# Don't open a Finder window when mounting a volume.
defaults write com.apple.finder OpenWindowForNewRemovableDisk -bool false

# Allow quitting the app via ⌘ + Q; doing so will also hide desktop icons.
defaults write com.apple.finder QuitMenuItem -bool true

defaults write com.apple.finder ShowExternalHardDrivesOnDesktop -bool false
defaults write com.apple.finder ShowHardDrivesOnDesktop -bool false
defaults write com.apple.finder ShowRemovableMediaOnDesktop -bool false
defaults write com.apple.finder FXEnableExtensionChangeWarning -bool false
defaults write com.apple.finder FXEnableRemoveFromICloudDriveWarning -bool false
defaults write com.apple.finder FXRemoveOldTrashItems -bool true
defaults write com.apple.finder WarnOnEmptyTrash -bool false
defaults write com.apple.finder _FXSortFoldersFirst -bool true
defaults write com.apple.finder FXPreferredViewStyle -string "clmv"
defaults write com.apple.finder FXEnableExtensionChangeWarning -bool false
defaults write com.apple.finder FXArrangeGroupViewBy -string "Kind"
defaults write com.apple.desktopservices DSDontWriteUSBStores -bool true

defaults write com.apple.finder AppleShowAllFiles -bool true
defaults write -g AppleShowAllExtensions -bool true
defaults write com.apple.finder ShowPathbar -bool true
defaults write com.apple.finder FXDefaultSearchScope -string "SCcf"
defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool true
defaults write com.apple.desktopservices DSDontWriteUSBStores -bool true
chflags nohidden ~/Library && xattr -d com.apple.FinderInfo ~/Library
chflags nohidden /Volumes
defaults write com.apple.finder QuitMenuItem -bool true
defaults write -g NSScrollViewRubberbanding -bool false
defaults write com.apple.finder CreateDesktop -bool false


###############################################################################
## Firewall                                                                  ##
###############################################################################

# This turns on the macOS Firewall.
/usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on

# This is an added security measure as it gets your talkative computer to stop
# chatting with all the devices that may wander nearby or on the same network.
/usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on

# Turn this on to block all incoming web traffic. This effectively gives you
# control over when your apps communicate outward, plus it's a good security
# step to take.
/usr/libexec/ApplicationFirewall/socketfilterfw --setblockall

# Turn on logging if you want to track connections taking place.
/usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on

# This turns off the ability for signed apps to bypass the Firewall.
# I do this so that I can customize which apps I actually want connected
# to the internet, versus curbing the overly-chatty system apps I 
# never use and can't remove.
/usr/libexec/ApplicationFirewall/socketfilterfw --setallowsigned off

# Block internet access to the following apps because they're annoying.
allowApps=(
    /Applications/AdBlock.app
    /Applications/App\ Store.app
    /Applications/Apple\ Configurator.app
    /Applications/Bitwarden.app
    /Applications/Cakebrew.app
    /Applications/Calendar.app
    /Applications/Clock.app
    /Applications/CloudMounter.app
    /Applications/Contacts.app
    /Applications/CrossOver.app
    /Applications/DataGrip.app
    /Applications/Day\ One.app
    /Applications/Dictionary.app
    /Applications/Discord.app
    /Applications/Firefox.app
    /Applications/GitHub\ Desktop.app
    /Applications/iMazing\ Profile\ Editor.app
    /Applications/iMazing.app
    /Applications/IntelliJ\ IDEA.app
    /Applications/Jump\ Desktop.app
    /Applications/LastPass.app
    /Applications/Lulu.app
    /Applications/Mail.app
    /Applications/Parallels\ Desktop.app
    /Applications/Photos.app
    /Applications/Postman.app
    /Applications/Proton\ Mail\ Bridge.app
    /Applications/ProtonVPN.app
    /Applications/PyCharm\ Edu.app
    /Applications/Rider.app
    /Applications/Safari.app
    /Applications/Sequel\ Ace.app
    /Applications/Shortcuts.app
    /Applications/Spotify.app
    /Applications/System\ Settings.app
)
echo "Giving internet access to apps..."
/usr/libexec/ApplicationFirewall/socketfilterfw --add "${allowApps[@]}"

# Block internet access to the following apps because they're annoying.
blockApps=(
    /Applications/AppLocker.app
    /Applications/Books.app
    /Applications/Calculator.app
    /Applications/Chess.app
    /Applications/Font\ Book.app
    /Applications/Home.app
    /Applications/Image\ Capture.app
    /Applications/Launchpad.app
    /Applications/MacroRecorder.app
    /Applications/Maps.app
    /Applications/Messages.app
    /Applications/Mission\ Control.app
    /Applications/Music.app
    /Applications/News.app
    /Applications/Photo\ Booth.app
    /Applications/Podcasts.app
    /Applications/Preview.app
    /Applications/QuickTime\ Player.app
    /Applications/Siri.app
    /Applications/Stocks.app
    /Applications/TextEdit.app
    /Applications/Time\ Machine.app
    /Applications/TV.app
    /Applications/Voice\ Memos.app
)
echo "Blocking internet access to apps..."
/usr/libexec/ApplicationFirewall/socketfilterfw --blockapp "${blockApps[@]}"

###############################################################################
## Infrared Receiver                                                         ##
###############################################################################

defaults write /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled -int 0

# Uncomment below to enable
# defaults write /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled -int 1

###############################################################################
## Power Saving Settings                                                     ##
###############################################################################

pmset -a lidwake 1
pmset -a sms 0

# Restart automatically on power loss
pmset -a autorestart 1
pmset -a standby 0
pmset -a powernap 0
pmset -a disksleep 0
pmset -a sleep 0
pmset -a ttyskeepawake 0
pmset -a displaysleep 0
pmset -a tcpkeepalive 0
pmset -a lowpowermode 0
pmset -a womp 0

systemsetup -setrestartfreeze on
systemsetup -setcomputersleep Off > /dev/null

rm -rf /private/var/vm/sleepimage
touch /private/var/vm/sleepimage
chflags uchg /private/var/vm/sleepimage

###############################################################################
## Remote Access                                                             ##
###############################################################################

# Disable remote login.
launchctl unload -w /System/Library/LaunchDaemons/ssh.plist

# Disable the ARD Agent and Remove Access Privileges for All Users.
/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -configure -access -off


# Get rid of Apple Remote Desktop settings
sudo rm -rf /var/db/RemoteManagement ; \
sudo defaults delete /Library/Preferences/com.apple.RemoteDesktop.plist ; \
defaults delete ~/Library/Preferences/com.apple.RemoteDesktop.plist ; \
sudo rm -r /Library/Application\ Support/Apple/Remote\ Desktop/ ; \
rm -r ~/Library/Application\ Support/Remote\ Desktop/ ; \
rm -r ~/Library/Containers/com.apple.RemoteDesktop


# Disable TFTP
launchctl unload -F /System/Library/LaunchDaemons/tftp.plist
launchctl stop com.apple.tftpd

###############################################################################
## Safari                                                                    ##
###############################################################################

# Change the default fonts in Safari
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2StandardFontFamily Georgia
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2DefaultFontSize 16
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2FixedFontFamily Menlo
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2DefaultFixedFontSize 14

# Activate the Develop menu and Web Inspector
defaults write com.apple.Safari IncludeInternalDebugMenu -bool true
defaults write com.apple.Safari IncludeDevelopMenu -bool true
defaults write com.apple.Safari WebKitDeveloperExtrasEnabledPreferenceKey -bool true
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2DeveloperExtrasEnabled -bool true
defaults write -g WebKitDeveloperExtras -bool true

###############################################################################
## Screencaptures                                                            ##
###############################################################################

defaults write com.apple.screencapture location -string "${HOME}/medien"

defaults write com.apple.screencapture type -string "png"

###############################################################################
## TextEdit                                                                  ##
###############################################################################

# Create an untitled document when launching
defaults write com.apple.TextEdit NSShowAppCentricOpenPanelInsteadOfUntitledFile -bool false

# Turn off rich text mode.
defaults write com.apple.TextEdit RichText -int 0

###############################################################################
## Trackpad, Mouse, Keyboard, Bluetooth Accessories, and Input               ##
###############################################################################

# Changes targeting the following domains:
# - com.apple.driver.AppleBluetoothMultitouch.trackpad
# - 

# Int or bool?
# defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad TrackpadRightClick -int 1
# defaults write com.apple.driver.AppleBluetoothMultitouch.trackpage TrackpadRotate -int 0
# defaults write com.apple.driver.AppleBluetoothMultitouch.trackpage Clicking -bool false

# Increase sound quality for Bluetooth headphones/headsets.
defaults write com.apple.BluetoothAudioAgent "Apple Bitpool Min (editable)" -int 40

# Enable the press-and-hold behavior to access additional characters.
defaults write -g ApplePressAndHoldEnabled -bool true

###############################################################################
## Kill Affected Applications                                                ##
###############################################################################

for app in "Activity Monitor" \
	"Address Book" \
	"Calendar" \
	"cfprefsd" \
	"Contacts" \
	"CrossOver" \
	"DataGrip" \
	"Dock" \
	"FaceTime" \
	"Finder" \
	"Firefox" \
	"Mail" \
	"Maps" \
	"Messages" \
	"Music" \
	"Photos" \
	"Podcasts" \
	"Rider" \
	"Safari" \
	"Stocks" \
	"SystemUIServer" \
	"Terminal" \
	"TextEdit" \
	"Transmission" \
	"iCal"; do
	killall "${app}" &> /dev/null
done
echo "Configuration completed. Some of these changes will require a logout/restart to take effect."